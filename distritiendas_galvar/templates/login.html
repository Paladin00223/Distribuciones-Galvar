<!DOCTYPE html>
<html lang="es">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión - Distribuciones Galvar</title>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

</head>

<body class="public-layout">

    <nav>
        <div class="nav-buttons">
          <a href="{{ url_for('main.principal') }}"><button><i class="fas fa-home"></i> Inicio</button></a>
        </div>
        <a href="{{ url_for('main.register') }}"><button class="cerrar" style="background-color: rgb(121, 255, 121);"><i class="fas fa-user-plus"></i> Registrarse</button></a>
    </nav>

    <main>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <header>
            <section>
              <h1>¡Qué alegría tenerte de vuelta!</h1>
            </section>
            <div>
              <h2>Inicia Sesión</h2>
            </div>
        </header>

        <div class="form-container">
            <!--
                CORRECCIÓN 1: El id del formulario debe ser "login-form" para que coincida con login.js
                CORRECCIÓN 2: Se añade novalidate para que las validaciones de JS tomen el control.
            -->
            <form id="login-form" method="POST" novalidate>
                <!-- CORRECCIÓN 3: Añadimos un div para mostrar los errores de login desde JavaScript -->
                <div id="login-error" class="alert alert-danger" style="display:none;"></div>

                <div class="form-group">
                    <!-- CORRECCIÓN 4: Cambiamos el id y name a "email" para que coincida con login.js y el backend -->
                    <label for="email">Email o Nombre de Usuario</label>
                    <input type="text" id="email" name="email" required autocomplete="username">
                </div>
                <div class="form-group password-container">
                    <label for="password">Contraseña</label>
                    <input type="password" id="password" name="password" class="form-control" required autocomplete="current-password">
                    <span class="toggle-password" id="togglePassword"><i class="fas fa-eye"></i></span>
                </div>
                <!-- MEJORA: Añadimos id y spans para el estado de carga -->
                <button type="submit" class="btn-register" id="login-submit-btn">
                    <span class="btn-text">Iniciar Sesión</span>
                    <span class="spinner" style="display: none;"></span>
                </button>
            </form>
            <p class="login-link">¿No tienes cuenta? <a href="{{ url_for('main.register') }}">Regístrate aquí</a></p>
        </div>
    </main>

    <footer>
        <a href="https://wa.me/573123456789" target="_blank" rel="noopener noreferrer">
    <button class="whatsapp-button">
        <i class="fab fa-whatsapp"></i> Contáctanos por WhatsApp
    </button>
</a>
        <br>
        &copy; 26 mayo 2025 - Distribuciones Galvar. Todos los derechos reservados
    </footer>

    <script src="{{ url_for('static', filename='js/login.js') }}"></script>

</body>

</html>